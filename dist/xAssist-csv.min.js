/**
* @preserve
* https://github.com/GregBee2/xassist-csv#readme Version 1.0.6.
*  Copyright 2018 undefined.
*  Created on Thu, 15 Mar 2018 12:10:26 GMT.
*/
!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("@xassist/xassist-object"),require("@xassist/xassist-array")):"function"==typeof define&&define.amd?define(["exports","@xassist/xassist-object","@xassist/xassist-array"],r):r(e.xa=e.xa||{},e.xa,e.xa)}(this,function(e,d,S){"use strict";var n=[59],t={headersIncluded:!1,headerPrefix:"column_",spaceAllowedBetweenDelimiterAndQuote:!0,treatConsecutiveDelmitersAsOne:!1,removeLeadingEmptyRows:!0,removeTrailingEmptyRows:!0,removeInnerEmptyRows:!1,trimValues:!0,emptyValuesAreNull:!0},i={incorrectTrailingQuote:"Unexpected token found after closing Quote for value",incorrectQuote:"Unexpected Quote found inside value"};function o(e,r){return d.object(e).mergeUnique(r)}function h(e){for(var r=[],n=0,t=e.length;n<t;n++)r.push(e.charCodeAt(n));return r}function m(e){return new RegExp('["'+e.map(String.fromCharCode).join("")+"\n\r]")}function p(e,p,v,g,x,y){var A=34,C=10,j=13,b=32,w={},O={},I={};return y=void 0===y?1/0:Number(y),function(u){var e,o=[],r=[],n=[],a=!0,c={},s=u.length,l=x||0,t=0,f=s<=0,d=!1,h=[];function m(e){c={id:e,lineIndex:t,characterIndex:l},a=!1}function i(){var e,r,n,t,i;if(f)return w;if(d)return d=!1,O;function o(){return(i=u.charCodeAt(l++))===C?d=!0:i===j&&(d=!0,u.charCodeAt(l)===C&&++l),d}for(e=l,n=!1,t=u.charCodeAt(e)===A||v.spaceAllowedBetweenDelimiterAndQuote;l<s;){if(n){if(t){for(;l<s&&u.charCodeAt(l++)!==A||u.charCodeAt(l++)===A;);if(r=l-=2,v.spaceAllowedBetweenDelimiterAndQuote)for(;l<s&&u.charCodeAt(++l)===b;);else l++;return o()||(f=s<=l)||~g.indexOf(i)?u.slice(e,r).replace(/""/g,'"'):(m("incorrectTrailingQuote"),I)}return m("incorrectQuote"),I}if(o()||~g.indexOf(i))return u.slice(e,l-1);i===A?(n=!0,e=l):i!==b&&(t=!1)}return f=!0,u.slice(e,s)}for(;t<=y&&(e=i())!==w&&a;){for(r=[],n=[];e!==O&&e!==w&&e!==I;){if(v.trimValues&&(e=e.trim()),v.emptyValuesAreNull&&!e.length&&(e=null),r.push(e),!d&&v.treatConsecutiveDelmitersAsOne){for(;l<s&&~g.indexOf(u.charCodeAt(l++)););l--}e=i()}if(a){if(null==(n=p?p(r,t):r)||r.length&&0!==r.join("").length||h.push(t),t++,null==n)continue;o.push(n)}}return function(){for(var e=o.length-1,r=S.array(h).groupSequence(function(e,r){return r-e==1}),n=[],t=0,i=r.length;t<i;t++)(v.removeLeadingEmptyRows&&0===r[t][0]||v.removeInnerEmptyRows&&0!==r[t][0]&&r[t][r[t].length-1]!==e||v.removeTrailingEmptyRows&&r[t][r[t].length-1]===e)&&(n=n.concat(r[t]));return{result:o.filter(function(e,r){return!~n.indexOf(r)}),emptyRecordLines:h,error:c,validCSV:a,startIndex:x,endIndex:l}}()}(e)}e.csv=function(){var s=d.object(t).clone(),l=n,f=0,r=m(l);function a(e){var r,n,t,i,o,u;for(f=0;r=p(e,void 0,s,l,f,0),f=r.endIndex,1!==r.result.length&&r.validCSV;);if(r.validCSV){r.result[0]=S.array(r.result[0]).replaceNull(function(e,r){return s.headerPrefix+r});for(var a=0,c=r.result[0].length;a<c;a++){for(o=r.result[0][a];r.result[0].indexOf(o)<a&&-1<r.result[0].indexOf(o);)1===(i=o.split("_")).length?(n=i[0],t=-1):(t=i.pop(),u=t,!isNaN(parseFloat(u))&&isFinite(u)&&Number(t)%1==0?(t=Number(t),n=i.join("_")):(n=i.concat(t).join("_"),t=-1)),o=n+"_"+ ++t;r.result[0][a]=o}}return r}function c(e,r){return e.header=r,e.validCSV||(e.error.message=i[e.error.id]),e}function u(e){return null===e?"":r.test(e)?'"'+e.replace(/"/g,'""')+'"':e}return 1===arguments.length?"string"==typeof arguments[0]?(l=h(arguments[0]),r=m(l)):s=o(s,arguments[0]):1<arguments.length&&(l=h(arguments[0]),r=m(l),s=o(s,arguments[1])),{toArray:function(e,r,n){var t;if(s.headersIncluded){if(!(t=a(e)).validCSV)return c(t);t=t.result[0]}else t=[];return n=n||t,c(p(e,r,s,l,f),n)},toObject:function(e,n,r){var t,i,o,u;if(s.headersIncluded){if(!(i=a(e)).validCSV)return c(i);i=i.result[0]}else i=[];return o=r=r||i,u=s.headerPrefix,o=Array.isArray(o)?o:[],u=u||"field_",u=o.reduce(function(e,r){for(;r.substr(0,e.length)===e;)e+="_";return e},u),t=function(e){return e.reduce(function(e,r,n){return e[o[n]||u+n]=r,e},{})},c(p(e,n?function(e,r){return n(t(e),r)}:t,s,l,f),r)},fromObject:function(e,r){var n,t,i,o=String.fromCharCode(l[0]);return i=(r=r||[]).reduce(function(e,r,n){return e[r]=n,e},{}),n=function(e,r){var n=[];return d.object(e).forEach(function(e,r){i.hasOwnProperty(r)||(i[r]=Object.keys(i).length),n[i[r]]=u(e)}),n.join(r)},t=function(e){return n(e,o)},r=r||[],e.map(t),[r.map(function(e){return u(e)}).join(o)].concat(e.map(t)).join("\n")},fromArray:function(e,r){var n=String.fromCharCode(l[0]),t=function(e){return r=n,e.map(function(e){return u(e)}).join(r);var r};return[t(r=r||[])].concat(e.map(t)).join("\n")}}},Object.defineProperty(e,"__esModule",{value:!0})});